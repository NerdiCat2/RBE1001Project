// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft      line          G               
// LineTrackerRight     line          H               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft      line          G               
// LineTrackerH         line          H               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerG         line          G               
// LineTrackerH         line          H               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerG         line          G               
// LineTrackerRight         line          B               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive          motor_group   2, 10           
// Left_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive          motor_group   2, 10           
// LEFT_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// RIght                motor_group   2, 10           
// LEFT_Drive           motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// RIght                motor_group   2, 10           
// LEFT                 motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// LEFT                 motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// Left_Drive               motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Push                 motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// Left_Drive               motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// Motor7               motor         7               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// Left_Drive               motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// Left_Drive               motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// Left_Drive               motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// ---- END VEXCODE CONFIGURED DEVICES ----
// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A               
// LineTrackerRight         line          B               
// Right_Drive              motor_group   2, 10           
// Left_Drive               motor_group   1, 9            
// doors                motor_group   3, 8            
// arm                  motor         5               
// ---- END VEXCODE CONFIGURED DEVICES ----

#include "main.h"
#include "vex.h"
#include <iostream>
#include <math.h>

// ---- START VEXCODE CONFIGURED DEVICES ----
// Robot Configuration:
// [Name]               [Type]        [Port(s)]
// LineTrackerLeft         line          A
// LineTrackerRight         line          B
// Right_Drive              motor_group   2, 10
// Left_Drive               motor_group   1, 9
// doors                motor_group   6, 8
// arm                  motor         5
// ---- END VEXCODE CONFIGURED DEVICES ----

using namespace std;

double wheelDiameter = 10.16;
double track = 28.4;
int globalRpm = 100;
double armPos = 3600;
enum ArmPositions {Up=3600, Ramp=1000, Dump=500, Down=0};
int main() {
  vexcodeInit();
  cout << "starting..." << endl;
  // demoDay();
  // armUp(3600);
  //lineFollow(1.5);
  //move(200.0);
  armTo(Ramp);
  move(130.0);
  armTo(Dump);
  cout << "end" << endl;
}

// Given a target distance, drive straight for the given distance.
void move(double cm) {
  cout << "moving " << cm << "cm..." << endl;
  double degree = distanceToDegree(cm);
  Left_Drive.rotateFor(degree, deg, globalRpm, rpm, false);
  Right_Drive.rotateFor(degree, deg, globalRpm, rpm);
}

// Given a target angle turn the BaseBot a specified angle.
void turnAngle(double angle) {
  cout << "turning " << angle << "degree..." << endl;
  double cm = (track * M_PI * angle) / 360;
  double degree = distanceToDegree(cm);
  Left_Drive.rotateFor(degree, deg, globalRpm, rpm, false);
  Right_Drive.rotateFor(-degree, deg, globalRpm, rpm);
}

// Changes Distance in cm to degrees
double distanceToDegree(double cm) {
  return (cm * 360 * 5) / (wheelDiameter * M_PI);
}

// Proportional Control
// turn speed = k*(sens1-sens2)
void lineFollow(double k) {
  double turnSpeed;
  vex::task::sleep(1000);
  Left_Drive.spin(fwd);
  Right_Drive.spin(fwd);
  while (true) {
    turnSpeed = k * (LineTrackerLeft.reflectivity() - LineTrackerRight.reflectivity());
    cout << LineTrackerLeft.reflectivity(pct) << "   "
         << LineTrackerRight.reflectivity(pct) << "turn speed: " << turnSpeed
         << endl;
    Left_Drive.setVelocity(100 - turnSpeed, rpm);
    Right_Drive.setVelocity(100 + turnSpeed, rpm);
    vex::task::sleep(30);
  }
}

void openDoors() { doors.rotateFor(-105, deg, 60, rpm); }

void closeDoors() { doors.rotateFor(115, deg, 60, rpm); }

void armUp(double d) { arm.rotateFor(d, deg, globalRpm, rpm); }

void armTo(double pos){
  armUp(pos-armPos);
  armPos=pos;

}

void demoDay() {
  move(-35.0);
  turnAngle(-90);
  armUp(-3600);
  openDoors();
  move(100.0);
}